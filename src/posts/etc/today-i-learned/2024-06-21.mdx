---
title: 'ì•¡í‹°ë¹„í‹° ê²°ê³¼ë¥¼ ê°€ì ¸ì™€ë³´ì'
date: '2024-06-21'
description: 'registerForActivityResultê°€ ë­ì§€?'
tags:
  - 'ì•ˆë“œë¡œì´ë“œ'
---

> âœ¨ **ì˜¤ëŠ˜ ê³µë¶€í•œ ê²ƒ**
>
```
- ì•Œê³ ë¦¬ì¦˜ í• ì¸ í–‰ì‚¬ í’€ì´
- ê°œì¸ ê³¼ì œ ë””ìì¸ í•´ë³´ê¸°
```
>

## ê°œìš”

> **âœ…  êµ¬í˜„í•  ê¸°ëŠ¥**
> 
> 
> íšŒì› ê°€ì… í˜ì´ì§€ì—ì„œ ì…ë ¥í•œ ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ê°€ íšŒì› ê°€ì… ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•  ë•Œ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ë„ë¡ êµ¬í˜„í•©ë‹ˆë‹¤.
> 
> í‚¤ì›Œë“œ: [`registerForActivityResult`](https://developer.android.com/training/basics/intents/result?hl=ko)
> 

## ê²°ê³¼ë¥¼ ìœ„í•´ ì•¡í‹°ë¹„í‹° ì‹¤í–‰í•˜ê¸°

í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰ í•´ë³´ë‹ˆ ë‹¤ë¥¸ ì•¡í‹°ë¹„í‹°ë¥¼ ì‹œì‘ì‹œí‚¤ê³  ë‚˜ì„œ ê·¸ ì•¡í‹°ë¹„í‹°ë¡œë¶€í„° ê²°ê³¼ë¥¼ ë°›ê³ ì í•  ë•Œ ì‚¬ìš©í•˜ëŠ” APIë¼ê³  í•œë‹¤. ì¦‰, **ê²°ê³¼ë¥¼ ìœ„í•œ ì•¡í‹°ë¹„í‹°ë¥¼ ì‹œì‘í•  ë•Œ ì‚¬ìš©**í•˜ëŠ” ê²ƒì´ [`registerForActivityResult`](https://developer.android.com/reference/androidx/activity/result/ActivityResultCaller#registerForActivityResult(androidx.activity.result.contract.ActivityResultContract,androidx.activity.result.ActivityResultCallback)) ì´ë‹¤.

ë§Œì•½ ê²°ê³¼ë¥¼ ìœ„í•œ ì•¡í‹°ë¹„í‹°ê°€ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” í”„ë¡œì„¸ìŠ¤ì™€ ì•¡í‹°ë¹„í‹°ê°€ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. ê·¸ë˜ì„œ ê²°ê³¼ë¥¼ ìœ„í•œ ì•¡í‹°ë¹„í‹°ë¥¼ ì‹¤í–‰í•˜ëŠ” ê³³ì—ì„œ ì½œë°± í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤. ë˜ ì•¡í‹°ë¹„í‹°ë¥¼ ë§Œë“¤ê¸° ì „ì— `registerForActivityResult` ë¥¼ í˜¸ì¶œí•´ì•¼ ì•ˆì „í•˜ë‹¤ê³  í•œë‹¤. 

```kotlin
// ActivityResultLauncher ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
// contract: ê²°ê³¼ë¥¼ ìƒì„±í•˜ëŠ” ë° í•„ìš”í•œ input íƒ€ì…ê³¼ output íƒ€ì… ì •ì˜ (ê²°ê³¼ ë³€í™˜ ë°©ì‹)
// callback: contractì— ì •ì˜ëœ íƒ€ì…ìœ¼ë¡œ ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤. onActivityResult() ë©”ì†Œë“œê°€ í¬í•¨ëœ ì¸í„°í˜ì´ìŠ¤
val getResult = registerForActivityResult(contract) { callback }
```

### Contract

[Contract ì¢…ë¥˜](https://developer.android.com/reference/androidx/activity/result/contract/ActivityResultContract)ë¥¼ ì‚´í´ë³´ë©´ ì˜ìƒì´ë‚˜ ë¬¸ì„œ, ì´ë¯¸ì§€ ë“±ì„ ê°€ì ¸ì˜¤ëŠ” ë“± ì–´ë§ˆë¬´ì‹œí•œ ê±¸ ê°€ì ¸ì˜¤ëŠ” ì• ë“¤ì´ ë§ì€ë°, ë‚˜ì—ê²Œ í•„ìš”í•œ ê±´ ê³ ì‘ ê°™ì€ ì•±ì˜ ë‹¤ë¥¸ ì•¡í‹°ë¹„í‹°ì—ì„œ ì…ë ¥í•œ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ ë¬¸ìì—´ 2ê°œë‹¤. ì´ê±¸ ìœ„í•œ ContractëŠ” ë°”ë¡œ [`StartActivityForResult`](https://developer.android.com/reference/androidx/activity/result/contract/ActivityResultContracts.StartActivityForResult) ë¡œ, ì•„ë¬´ëŸ° ë³€í™˜ ì—†ì´ Intentë¥¼ ë°›ì•„ [ActivityResult](https://developer.android.com/reference/androidx/activity/result/ActivityResult) í˜•íƒœë¡œ ë°˜í™˜í•´ì¤€ë‹¤ê³  í•œë‹¤. 

```kotlin
val getResult = registerForActivityResult(ActivityResultContracts.StartActivityForResult()) {
    // it ìœ¼ë¡œ ActivityResultì— ì ‘ê·¼ ê°€ëŠ¥
    // ActivityResultì˜ dataë¡œëŠ” Intentê°€ ë“¤ì–´ì˜¨ë‹¤.
}
```

### ì•¡í‹°ë¹„í‹° ì‹¤í–‰

ì‹¤í–‰ì€ `registerForActivityResult` ë¡œë¶€í„° ë°˜í™˜ëœ ActivityResultLauncher ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ì¸ìŠ¤í„´ìŠ¤ì˜ launch()ë¥¼ í˜¸ì¶œí•˜ë©´ ê²°ê³¼ë¥¼ ìœ„í•œ ì•¡í‹°ë¹„í‹°ê°€ ì‹œì‘ëœë‹¤. ì‹œì‘í•œ ì•¡í‹°ë¹„í‹°ê°€ ì¢…ë£Œë˜ë©´ callbackì— ì‘ì„±í•œ ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤. Intentë¥¼ ì‹œì‘í•˜ëŠ” `startActivity`ì™€ ë¹„ìŠ·í•œ ê²ƒ ê°™ë‹¤. 

```kotlin
val intent = Intent(this, SignUpActivity::class.java)
getResult.launch(intent)
```

## ê²°ê³¼ë¥¼ ë„˜ê²¨ì£¼ê¸°

ìœ„ì—ì„œ ë‚´ê°€ ì‚¬ìš©í•˜ëŠ” StartActivityForResultëŠ” Intentë¥¼ ë°›ëŠ”ë‹¤ê³  í–ˆë‹¤. ê²°ê³¼ë¥¼ ìœ„í•œ ì•¡í‹°ë¹„í‹°ì—ì„œ ê·¸ëƒ¥ Intentë¥¼ ë§Œë“¤ì–´, putExtraë¡œ ì „ë‹¬í•  ê°’ì„ ë„£ì–´ì£¼ê³ , [`setResult()`](https://developer.android.com/reference/android/app/Activity#setResult(int,%20android.content.Intent))ë¡œ ì „ë‹¬ë§Œ í•˜ë©´ ëœë‹¤.

```kotlin
val intent = Intent(this, SignInActivity::class.java)

intent.putExtra("id", id)
intent.putExtra("password", password)

// setResult(resultCode: Int, data: Intent)
// resultCode: RESULT_CANCELED, RESULT_OK
// resultCodeì™€ dataëŠ” ì›ë˜ ì•¡í‹°ë¹„í‹°ì—ê²Œ ì „ë‹¬ëœë‹¤.
setResult(RESULT_OK, intent)

// ì „ë‹¬ë§Œ í•˜ê³  ì•¡í‹°ë¹„í‹° ì¢…ë£Œ ì•ˆì‹œí‚¤ë©´ ì•ˆë¨... (ë‚´ê°€ ê·¸ë¬ìŒ ã…..)
finish()
```

## ê²°ê³¼ ë°›ê¸°

ê²°ê³¼ë¥¼ ì „ë‹¬ë°›ì•˜ë‹¤ë©´, callbackì´ í˜¸ì¶œëœë‹¤. Intentë¥¼ ë„˜ê²¨ì£¼ì—ˆê¸° ë•Œë¬¸ì— íŠ¹ë³„íˆ ìƒˆë¡œ ì•Œì•„ì•¼ í•  ê±´ ì—†ë‹¤. ë‹¤ë§Œ, ê°™ì´ ë„˜ê²¨ì¤€ resultCodeë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ê² ..ì§€?

```kotlin
// resultCodeê°€ RESULT_OKë¼ë©´,
if (it.resultCode == RESULT_OK) {
    // Intentì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ì
    val id = it.data?.getStringExtra("id") ?: ""
    val password = it.data?.getStringExtra("password") ?: ""

    idInput.setText(id)
    passwordInput.setText(password)

    showToast("íšŒì› ê°€ì… ì„±ê³µ")
}
```

## ë§ˆì¹˜ë©°

í•˜ë‚˜ ì•Œì•„ë³´ëŠ”ë° ë¬¸ì„œë§Œ ëª‡ ê°œë¥¼ ë³¸ ê±´ì§€ ëª¨ë¥´ê² ë‹¤. ì£„ë‹¤ ì²˜ìŒë³´ëŠ” ë‹¨ì–´ë“¤ì´ë¼ ëˆˆì•ì´ ê¹œê¹œí•´ì§ˆ ë»” í–ˆì§€ë§Œ, ë²ˆì—­ë§Œ ìˆë‹¤ë©´ ë‚˜ëŠ” ë¬´ì ì´ë‹¤. í•œê¸€ ìµœê³ ìµœê³  ğŸ‘
