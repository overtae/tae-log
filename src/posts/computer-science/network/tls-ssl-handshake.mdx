---
title: 'TLS/SSL Handshake'
date: '2022-11-18'
description: 'μ•”νΈν™” λ λ°μ΄ν„° μ „λ‹¬ κ³Όμ •'
tags:
  - 'TLS'
  - 'SSL'
---

## SSL/TLS ?

HTTPSλ” SSL/TLS μ „μ†΅ κΈ°μ μ„ μ‚¬μ©ν•λ‹¤. μ—¬κΈ°μ„ SSLκ³Ό TLSλ” λΈλΌμ°μ €μ™€ μ„λ²„ κ°„μ μΈμ¦ λ° λ°μ΄ν„° μ•”νΈν™”λ¥Ό μ κ³µν•λ” μ•”νΈν™” ν”„λ΅ν† μ½λ΅ μ•„λμ™€ κ°™μ€ λ»μ„ κ°–κ³  μλ‹¤.

β€” SSL : Secure Socket Layer

β€” TLS : Transport Layer Security

λ‘ λ‹¨μ–΄ λ‹¤ Secureκ³Ό Layerκ°€ λ“¤μ–΄κ°€ μλ” κ²ƒμ„ μ• μ μλ‹¤. μ¦‰, SSL/TLS μ „μ†΅ κΈ°μ μ€ μΌλ°μ μΈ μΈν„°λ„· ν†µμ‹  (ex. TCP, UDP)μ— μ•μ „ν• κ³„μΈµ(Layer)μ„ μ¶”κ°€ν•λ” λ°©μ‹μ΄λ‹¤. μ΄λ¥Ό κµ¬ν„ν•λ ¤λ©΄ μ›Ή μ„λ²„μ— SSL/TLS μΈμ¦μ„λ¥Ό μ„¤μΉν•΄μ•Ό ν•λ‹¤. TLSλ” SSLμ κ°μ„  λ²„μ „μΈλ°, νΈμμƒ SSL μΈμ¦μ„λΌκ³  μ­‰ λ¶€λ¥΄κ³  μλ‹¤κ³  ν•λ‹¤. 

*~~κ°μ„  λ²„μ „μΈλ° μ΄λ¦„μ΄ λ‹¤λ¥Έ μ΄μ λ” SSLμ„ κ°λ°ν• Netscapeμ‚¬κ°€ μ—…λ°μ΄νΈμ— μ°Έμ—¬ν•μ§€ μ•κ² λμ–΄ μ†μ κ¶ λ³€κ²½μ„ μ„ν•΄μ„μ€λ‹¤κ³  ν•λ‹¤..~~*

## SSL/TLS μΈμ¦μ„

SSL/TLS μΈμ¦μ„λ” SSL/TLS ν”„λ΅ν† μ½μ„ μ‚¬μ©ν•μ—¬ μ›Ή λΈλΌμ°μ €κ°€ μ›Ή μ‚¬μ΄νΈμ— λ€ν•΄ μ•”νΈν™”λ λ„¤νΈμ›ν¬ μ—°κ²°μ„ ν™•μΈν•κ³  μ„¤μ •ν•  μ μκ² ν•΄μ¤€λ‹¤.

### μ΄μ 

π‘‰ κ°μΈ λ°μ΄ν„° λ³΄νΈ

: λΈλΌμ°μ €μ™€ μ›Ή μ‚¬μ΄νΈ κ°„μ λ¨λ“  ν†µμ‹ μ„ μ•”νΈν™”

π‘‰ μ‚¬μ©μ μ‹ λΆ° κ°•ν™”

: μ‚¬μ©μλ” SSL/TLS λ³΄νΈλ¥Ό ν†µν•΄ λ°μ΄ν„°κ°€ λ³΄νΈλκ³  μμμ„ μΈμ§€ 

π‘‰ κ·μ  μ¤€μ μ§€μ›

: λ°μ΄ν„° κΈ°λ°€μ„± λ° λ³΄νΈμ— λ€ν• μ—…κ³„ κ·μ • μ¤€μ

π‘‰ SEO κ°μ„ 

: κ²€μƒ‰ μ—”μ§„μ—μ„ SSL/TLS μΈμ¦μ„κ°€ μ—†λ” μ›Ή μ‚¬μ΄νΈλ³΄λ‹¤ λ” λ†’μ€ μμ„ μ°¨μ§€

### μ£Όμ” μ›μΉ™

π‘‰ μ•”νΈν™”

: κ³µκ°ν‚¤ μ•”νΈν™” λ°©μ‹μ„ μ‚¬μ©ν• λ°μ΄ν„° μ•”νΈν™”

π‘‰ μΈμ¦

: μ›Ή μ„λ²„μ μ‹ μ›μ„ μ‹ λΆ°ν•  μ μλ”μ§€ ν™•μΈ

π‘‰ λ””μ§€ν„Έ μ„λ…

: μ „μ†΅λλ” μΈμ¦μ„λ¥Ό μ΅°μ‘ν•μ§€ μ•μ•λ”μ§€ ν™•μΈ (λ¬΄κ²°μ„±)

## TLS/SSL μ‘λ™λ°©μ‹

TSL/SSLμ€ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„μ— handshakeλ¥Ό ν†µν•΄ μΈμ¦μ΄ μ΄λ£¨μ–΄μ§„λ‹¤.

### TLS/SSL Handshake κ³Όμ •

ν†µμ‹ μ„ ν•λ” λΈλΌμ°μ €μ™€ μ›Ή μ„λ²„κ°€ μ„λ΅ μ•”νΈν™” ν†µμ‹ μ„ μ‹μ‘ν•  μ μλ„λ΅ μ‹ λ¶„μ„ ν™•μΈν•κ³  ν•„μ”ν• μ •λ³΄λ¥Ό ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ£Όκ³ λ°›λ” κ³Όμ •μ΄λ‹¤.

![catchpoint.com](/posts/computer-science/network/tls-handshake.png "https://www.catchpoint.com/blog/wireshark-tls-handshake")

#### ClientHello

ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ—°κ²°μ„ μ‹λ„ν•λ©° μ „μ†΅ν•λ” ν¨ν‚·μΌλ΅ μ•„λμ™€ κ°™μ€ μ •λ³΄λ¥Ό λ³΄λ‚Έλ‹¤.

π‘‰ ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ© κ°€λ¥ν• SSL (or TLS) λ²„μ „ μ •λ³΄

π‘‰ ν΄λΌμ΄μ–ΈνΈκ°€ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹ λ©λ΅ (Cipher Suite)

π‘‰ ν΄λΌμ΄μ–ΈνΈκ°€ μƒμ„±ν• μ„μμ λ‚μ (Random Byte λ¬Έμμ—΄, μ΄ν• randC)

π‘‰ μ΄μ „μ— SSL Handshakeλ¥Ό ν• κ²½μ°, κ·Έλ• μƒμ„±λ Session ID

: Session IDκ°€ μλ‹¤λ©΄, μ„ κ³Όμ •μ„ λ°λ³µν•μ§€ μ•λ”λ‹¤.

π‘‰ κΈ°νƒ€ extension μ •λ³΄

<Callout type="success" icon="π’΅">

**Cipher Suite?** μ•μ „ν• ν‚¤ κµν™, μ „λ‹¬ λ€μƒ μΈμ¦, μ•”νΈν™” μ•κ³ λ¦¬μ¦, λ©”μ‹μ§€ λ¬΄κ²°μ„± ν™•μΈ μ•κ³ λ¦¬μ¦μ„ μ„ν•΄ μ‚¬μ©ν•λ” λ°©μ‹μ„ λ¬¶μ–΄ λ†“μ€ κ²ƒ

</Callout>

#### ServerHello

ν΄λΌμ΄μ–ΈνΈμ ν¨ν‚·μ„ λ°›μ€ μ„λ²„λ” μ•„λμ™€ κ°™μ€ μ •λ³΄λ¥Ό λ³΄λ‚Έλ‹¤.

π‘‰ ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ Cipher Suite μ¤‘ μ„λ²„κ°€ μ„ νƒν• ν•λ‚

π‘‰ μ„λ²„μ κ³µκ°ν‚¤κ°€ λ‹΄κΈ΄ SSL μΈμ¦μ„ (CAμ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” λ¨)

π‘‰ μ„λ²„κ°€ μƒμ„±ν• μ„μμ λ‚μ (μ΄ν• randS)

<Callout type="success" icon="π’΅">

**CA?** μΈμ¦ κΈ°κ΄€μΌλ΅ μ›Ή μ†μ μ, μ›Ή νΈμ¤ν… νμ‚¬ λλ” κΈ°μ—…μ— SSL/TLS μΈμ¦μ„λ¥Ό νλ§¤ν•λ” μ΅°μ§

</Callout>

#### Certificate

ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ SSL μΈμ¦μ„λ¥Ό CA κ³µκ°ν‚¤λ΅ λ³µνΈν™”ν•¨μΌλ΅μ¨ CAκ°€ λ°κΈ‰ν• κ²ƒμ΄ λ§λ”μ§€ ν™•μΈν•λ‹¤.

#### ServerKeyExchange

μ„λ²„μ κ³µκ°ν‚¤κ°€ SSL μΈμ¦μ„ λ‚΄λ¶€μ— μ—†λ” κ²½μ° μ„λ²„κ°€ μ§μ ‘ μ „λ‹¬ν•λ‹¤. λ§μ•½ κ³µκ°ν‚¤κ°€ SSL μΈμ¦μ„ λ‚΄λ¶€μ— μλ‹¤λ©΄ μƒλµλλ‹¤.

#### ServerHelloDone

μ„λ²„κ°€ ν–‰λ™μ„ λ§μ³¤λ‹¤λ” κ²ƒμ„ μ „λ‹¬ν•λ‹¤.

#### ClientKeyExchange

ν΄λΌμ΄μ–ΈνΈλ” ransCμ™€ randSλ¥Ό μ΅°ν•©ν•μ—¬ premaster secretμ„ μƒμ„±ν•λ‹¤. μ΄λ¥Ό SSL μΈμ¦μ„ λ‚΄λ¶€μ—μ„ μ¶”μ¶ν• μ„λ²„μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ μ„λ²„μ— μ „λ‹¬ν•λ‹¤. 

μ„λ²„λ” premaster secret μ„ λ³µνΈν™”ν• κ°’μ„ master secret κ°’μΌλ΅ μ €μ¥ν•λ‹¤. μ΄λ¥Ό μ‚¬μ©ν•μ—¬ λ€μΉ­ν‚¤ μ•”νΈν™”μ— μ‚¬μ©ν•  Session keyλ¥Ό μƒμ„±ν•λ‹¤. μ¦‰, μ΄ Session keyλ΅ μ£Όκ³ λ°›λ” λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κ³  λ³µνΈν™”ν•κ²λλ‹¤.

#### ChangeCipherSpec

ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ„λ΅μ—κ² λ³΄λ‚΄λ” ν¨ν‚·μΌλ΅ κµν™ν•  μ •λ³΄λ¥Ό λ¨λ‘ κµν™ν• λ’¤ ν†µμ‹ ν•  μ¤€λΉ„κ°€ λ‹¤ λμ—μμ„ μ•λ¦°λ‹¤.

#### Finished

SSL Handshakeλ¥Ό μΆ…λ£ν•λ‹¤.
